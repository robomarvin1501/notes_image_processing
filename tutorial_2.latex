\documentclass{article}
\usepackage{amssymb}
\usepackage{amsmath}
\usepackage{amsthm}
\usepackage{mathtools}
\usepackage{blindtext}
\usepackage{multicol}
\usepackage{graphicx}
\usepackage{placeins}
\usepackage{algpseudocode}
\usepackage{algorithm}
\usepackage{booktabs}
\usepackage{float}
\usepackage[bookmarks=true]{hyperref}
\usepackage{bookmark}
\usepackage{bbm}
\usepackage{wrapfig}
\usepackage[autostyle=true]{csquotes}
\graphicspath{ {./images/} }
\usepackage[bottom=0.5cm, right=1.5cm, left=1.5cm, top=1.5cm]{geometry}

\newtheorem{theorem}{Theorem}
\newtheorem{exercise}{Exercise}
\newtheorem{example}{Example}
\newtheorem{definition}{Definition}[section]

\newcommand{\R}{\ensuremath{\mathbb{R}}}
\newcommand{\N}{\ensuremath{\mathbb{N}}}
\newcommand{\Z}{\ensuremath{\mathbb{Z}}}
\newcommand{\p}{\ensuremath{\mathbb{P}}}
\newcommand{\E}{\ensuremath{\mathbb{E}}}
\newcommand{\F}{\ensuremath{\mathcal{F}}}
\newcommand{\1}{\ensuremath{\mathbbm{1}}}
\newcommand{\B}{\ensuremath{\mathbbm{B}}}

\title{Tutorial 2 - 1D Fourier Transform}
\author{Gidon Rosalki}
\date{2025-10-29}


\begin{document}
\maketitle

\section{Introduction}\label{sec:introduction} % (fold)
A chap called Fourier theorised that any periodic function (signal) can be decomposed into $F$, a set of $\sin$ and
$\cos$ periodic functions, of different frequencies (called a Fourier series). Since this is not a mathematical course,
we will not prove it, nor be expected to understand all the mathematical depths. \\ 
Given the set $F$, we can reconstruct $f$ without any loss of data. The Fourier Transform allows us to use the unique
properties of of decomposition into $\sin$ and $\cos$ on any function. \\ 

Given a complex number $c = a + bi = R \cdot e^{ialpha}$, where $e^{i\alpha} = \cos \left(\alpha\right) + i \sin
\left(\alpha\right)$. The absolute value is computed \[
    \left|c\right| = R = \sqrt{a^2 + b^2} 
\]
The \textit{phase} is $\alpha$ where \[
    \alpha = \tan^{-1} \left(\displaystyle\frac{b}{a}\right)
\]

And the \textit{conjugate}: \[
    \overline{c} = c^* = a - bi
\]
% section Introduction (end)

\section{Periodic functions}\label{sec:periodic_functions} % (fold)
A periodic function can be described sing its \textbf{frequency}, \textbf{amplitude}, and \textbf{phase shift}. The
\textbf{frequency} is how much time it takes to complete a \textit{complete} phase (so for $\sin$: $2\pi$). The
\textbf{amplitude} is the absolute maximum value of the wave. The \textbf{phase shift} is
how much the wave is shifted from its normal position. \\ 
The \textbf{wavelength} $\left(\lambda\right)$ is the distance over which a periodic wave's shape repeats. As a result, we can see that, since
the frequency is the number of waves per unit: \[
    f = \displaystyle\frac{1}{\lambda}
\]

So, for $\sin$, the wavelength is $2\pi$, and the frequency is $\displaystyle\frac{1}{2\pi}$, or in general for $\sin
\left(ax\right)$, there is a wavelength of $\displaystyle\frac{2\pi}{a}$, and a frequency of
$\displaystyle\frac{a}{2\pi}$. To save effor, we will normally put $2\pi$ inside the sin expression as well: $\sin
\left(2\pi \omega x\right)$, and have a frequency of $\omega$Hz, with a wavelength of $\displaystyle\frac{1}{\omega}$.
% section Periodic functions (end)

\section{Back to Fourier}\label{sec:back_to_fourier} % (fold)
By using the Fourier transformation, we are moving from the \textit{time} domain, to the \textit{frequency} domain. We
perform a decomposition into different resolutions, the low frequencies give us a rough general structure, and the high
frequencies the fine detail. This is very useful for signal understanding, and processing, for jobs like filtering,
removing noise, compression, and so on. 

\subsection{How do we do this?}%
\label{sub:How do we do this?}
We want to decompose $f \left(x\right)$ into a set of $\sin$ and $\cos$ functions of different frequencies: \[
    f \left(x\right) = \displaystyle\sum_{\omega}^{}a_\omega \cos \left(\displaystyle\frac{2\pi \omega x}{N}\right) +
    b_\omega \sin \left(\displaystyle\frac{2\pi \omega x}{N}\right)
\]
We need to find $a_\omega$ and $b_\omega$, and we have $N$ data points. This is done with the Fourier transformation.
% section Back to Fourier (end)

\subsection{Discrete Fourier Transform (DFT)}\label{sub:discrete_fourier_transform_dft_} % (fold)
DFT: \[
    F \left(\omega\right) = \displaystyle\sum_{x = 0}^{N - 1}f \left(x\right) e^{-\displaystyle\frac{2\pi i x \omega}{N}}
\]
Now is a good time to remember Euler's formula: \[
    e^{i \theta} = \cos \left(\theta\right) + i \sin \left(\theta\right)
\]
So: \begin{align*}
    F \left(\omega\right) &= \displaystyle\sum_{x = 0}^{N - 1}f \left(x\right) e^{-\displaystyle\frac{2\pi i x
    \omega}{N}} \\
                          &= \displaystyle\sum_{x = 0}^{N - 1} f \left(x\right) \left(\cos \left(-
                          \displaystyle\frac{2\pi x \omega}{N}\right) + i \cdot \sin \left(- \displaystyle\frac{2 \pi x
                  \omega}{N}\right)\right) \\ 
                          &= \displaystyle\sum_{x = 0}^{N - 1} f \left(x\right) \left(\cos \left(
                          \displaystyle\frac{2\pi x \omega}{N}\right) - i \cdot \sin \left(\displaystyle\frac{2 \pi x
                  \omega}{N}\right)\right) \\ 
                          &= \displaystyle\sum_{x = 0}^{N - 1} f \left(x\right) \cos \left(\displaystyle\frac{2 \pi x
                          \omega}{N}\right) - i \displaystyle\sum_{x = 0}^{N - 1} \sin \left(\displaystyle\frac{2 \pi x
                      \omega}{N}\right)
%                          &= \displaystyle\sum_{x = 0}^{N - 1} f \left(x\right) \cos \left(
%                          \displaystyle\frac{2\pi x \omega}{N}\right) - i \displaystyle\sum_{x = 0}^{N - 1} \sin \left(\displaystyle\frac{2 \pi x
%                  \omega}{N}\right)\right) \\ 
\end{align*}

And in this beautiful final expression, the first half (the sum over $\cos$) expresses $a_\omega$, and the second half
($i$ times the sum over $\sin$) expresses $b_\omega$.

We also have the IDFT (Inverse DFT): \[
    f \left(\omega\right) = \displaystyle\frac{1}{N}\displaystyle\sum_{\omega = 0}^{N - 1}F \left(\omega\right) e^{\displaystyle\frac{2\pi i x \omega}{N}}
\]

In real life, we use the Fast Fourier Transform (FFT), which takes only $O \left(N \log N\right)$, instead of $O
\left(N^2\right)$
% subsection Discrete Fourier Transform (DFT) (end)


\subsection{Properties}\label{sub:properties} % (fold)
The FT is linear: \begin{gather*}
    \Phi \left(f \left(x\right) + g \left(x\right)\right) = \Phi \left(f \left(x\right)\right) + \Phi \left(g
    \left(x\right)\right) \\ 
    \Phi \left(a \cdot f \left(x\right)\right) = a \cdot \Phi \left(f \left(x\right)\right)
\end{gather*}

Additionally, there is scaling: If $f \left(x\right)$ gives us the Fourier set $F \left(u\right)$, then \[
    f \left(ax\right) \to \displaystyle\frac{1}{\left|a\right|} F \left(\displaystyle\frac{u}{a}\right)
\]
Periodicity: \[
    \forall k \in \Z\ F \left(u\right) = F \left(u + kN\right)
\]

Symmetry: \begin{gather*}
    F \left(-u\right) = F^* \left(u\right) \\ 
    \left|F \left(u\right)\right| = \left|F \left(-u\right)\right|
\end{gather*}

So: \begin{gather*}
    F \left(u\right) = F^* \left(-u\right) = F^* \left(N - u\right) \\ 
    \left|F \left(u\right)\right| = \left|F \left(-u\right)\right| = \left|F \left(N - u\right)\right|
\end{gather*}
% subsection Properties (end)

What happens if we take $F \left(0\right)$? Well: \begin{align*}
    F \left(u\right) &= \displaystyle\frac{1}{N} \displaystyle\sum_{x = 0}^{N - 1}f \left(x\right)
    e^{\displaystyle\frac{-2 \pi i u x}{N}} \\
    F \left(0\right) &= \displaystyle\frac{1}{N} \displaystyle\sum_{x = 0}^{N - 1}f \left(x\right)
    e^{\displaystyle\frac{-2 \pi i 0 x}{N}} \\
                     &= \displaystyle\frac{1}{N} \displaystyle\sum_{x = 0}^{N - 1}f \left(x\right) \\ 
                     &\approx \text{ The signal average}
\end{align*}

Since the FT returns complex numbers: \[
    F \left(u\right) = R \left(u\right) + i \cdot I \left(u\right)
\]
To visualise, we use the amplitude: \[
    \left|F \left(u\right)\right| = \sqrt{R^2 \left(u\right) +  I^2 \left(u\right)}
\]

\subsection{Basis vectors}\label{sub:basis_vectors} % (fold)
DFT is a basis transform â€“ We are moving from the standard basis to the Fourier basis. So, this can be done by a matrix
multiplication: \[
    F \left(\omega\right) = \displaystyle\sum_{x = 0}^{N - 1}f \left(x\right) e^{-\displaystyle\frac{2\pi i x
    \omega}{N}} \leftrightarrow \vec{F} = M_{N \times N} \vec{f}
\]
Where \[
    \vec{f} = \begin{bmatrix}
        f \left(0\right) \\
        f \left(1\right) \\
        \vdots \\
        f \left(N - 1\right) \\
    \end{bmatrix}
\]
and similarly for $F$. Reminders of this content can be found in algorithms. \\ 
% subsection Basis vectors (end)


\section{Non-stationary signals}\label{sec:non_stationary_signals} % (fold)
A stationary signal has the same function, the entire time, but a non stationary signal changes function over time. The
Fourier transform provides localisation in the \textit{frequency} domain, but no localisation in time. In short, the
resultant graph shows peaks at frequencies, but not when they happen. A non stationary signal will, as a result, produce
a noisy Fourier transform, where a stationary one will not. 
% section Non-stationary signals (end)

\section{Sound}\label{sec:sound} % (fold)
Sound is a vibration that typically propagates as an audible wave of pressure, through a transmission medium such as a
gas, liquid or solid. We represent sound as a stationary, 1D, signal. \\ 

Image and sound representation are not very different: \begin{itemize}
    \item Quality: \begin{itemize}
            \item Image quality depends on resolution, the number of pixels in the image 
            \item Sound quality depends on the sampling rate (samples per second)
        \end{itemize}
    \item Memory: \begin{itemize}
        \item Images are represented using 8 bits per pixel (values between 0, and 255)
        \item In sound the bit depth (bits/sample) is defined as the amplitude resolution, so telephone and AM radio are
            8 bits, -127 to 127, and audio CDs are 16 bits (-32768, 32767)
    \end{itemize}
\end{itemize}
% section Sound (end)

\section{STFT}\label{sec:stft} % (fold)
When applying DFT on non-stationary signals, localisation in time is lost. To avoid this, we would like to apply DFT
independently on short-time segments. We do this by assuming that the segments are short enough to be considered
stationary. This is called the Short-Time Fourier Transform (STFT). This is done by the following steps: \begin{enumerate}
    \item Choose a window of finite length
    \item Place the window on top of signal at $t = 0$
    \item Truncate the signal using this window
    \item Compute DFT of the truncated signal, save results
    \item Incrementally slide the window to the right
    \item Go back to step 3, until window reaches the end of the signal
\end{enumerate}

Windows have various properties. Their shape for example, we often use rectangular, Gaussian, triangles, etc. The
\textit{length} $W$, is the size of the window. A longer length results in better frequency resolution, where a shorter
length results in better time resolution. Finally, the \textit{shift} $L$ describes how much the window moves every
time. A smaller shift results in smoother results, but a larger shift has less computation.

So, the STFT for time $t$ is as follows: \[
    F \left(\omega, t\right) = \displaystyle\sum_{x = -\infty}^{\infty} f \left(x\right) W \left(t - x\right) e^{-
        \displaystyle\frac{2 \pi i x \omega}{N}}
\]
and the ISTFT (where $K$ is a normalisation constant): \[
    f \left(x\right) = K \displaystyle\sum_{p = -\infty}^{\infty} \displaystyle\sum_{u = 0}^{N - 1}F \left(u,
        pL\right)e^{\displaystyle\frac{2 \pi i u x}{N}}
\]
% section STFT (end)

\section{Spectrograms}\label{sec:spectrograms} % (fold)
These are a visual representation of the spectrum of frequencies of a signal as it varies with time. A In a 3D
representation, the X axis represents time, Y the frequency, and the non existent Z is instead represented by colours
for the amplitude / magnitude. This helps us represent the localisation in time we achieved from STFT. \\ 

Sometimes, visualisation is not clear, due to the output range of the transform, which can give us very large values.
So, we want to compress the range. The log transform enables us to compress the dynamic range of the values, which has
the steps \begin{itemize}
    \item Compute $\log \left(\left|F \left(u\right)\right| + 1\right)$
    \item Scale to the full grey level range
\end{itemize}
% section Spectrograms (end)

\end{document}
